<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ุชุณุฌูู ุญุณุงุจ ูุฃุณุฑุฉ ูุณุชุถููุฉ ูู ููุตุฉ ูุฑู">
    <title>ุชุณุฌูู ุฃุณุฑุฉ ูุณุชุถููุฉ - ูุฑู</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles/design-system.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/pages-core.css">
</head>

<body class="auth-page">
    <div class="auth-container">
        <div class="auth-side">
            <div class="auth-box">
                <div class="auth-logo">
                    <img src="assets/logo.png" alt="ูุฑู">
                </div>
                <div class="auth-header">
                    <h1 class="auth-title">ุชุณุฌูู ุฃุณุฑุฉ ูุณุชุถููุฉ</h1>
                    <p class="auth-subtitle">ุดุงุฑู ูุฑูู ูุน ุถููู ุงูุฑุญูู</p>
                </div>

                <!-- Register Form -->
                <form id="family-register-form" class="auth-form">
                    <input type="hidden" id="user-role" value="host_family">

                    <!-- Family Info -->
                    <div class="form-group">
                        <label class="form-label" for="family-name">ุงุณู ุงูุฃุณุฑุฉ *</label>
                        <input type="text" id="family-name" class="form-input" placeholder="ุฃุณุฑุฉ ุขู ..." required>
                        <span class="form-error" id="family-name-error"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="city">ุงููุฏููุฉ *</label>
                        <select id="city" class="form-select" required>
                            <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
                            <option value="makkah">ููุฉ ุงูููุฑูุฉ</option>
                            <option value="madinah">ุงููุฏููุฉ ุงููููุฑุฉ</option>
                        </select>
                        <span class="form-error" id="city-error"></span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="address">ุนููุงู ุงููุฌูุณ *</label>
                        <textarea id="address" class="form-textarea" placeholder="ุงูุญูุ ุงูุดุงุฑุนุ ุฑูู ุงููุจูู..." required
                            rows="3"></textarea>
                        <span class="form-error" id="address-error"></span>
                    </div>

                    <!-- Google Maps Location -->
                    <div class="form-group">
                        <label class="form-label" for="google-maps-link">ุฑุงุจุท ูููุน Google Maps *</label>
                        <input type="url" id="google-maps-link" class="form-input"
                            placeholder="https://maps.google.com/?q=..." required>
                        <span class="form-error" id="maps-link-error"></span>
                        <small class="text-muted">
                            ๐ <a href="#" onclick="showMapsHelp(); return false;" class="link-text">ููู ุฃุญุตู ุนูู ุฑุงุจุท
                                Google Mapsุ</a>
                        </small>
                    </div>

                    <!-- Optional: Direct Coordinates -->
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="latitude">ุฎุท ุงูุนุฑุถ (ุงุฎุชูุงุฑู)</label>
                            <input type="number" id="latitude" class="form-input" placeholder="21.4225" step="any"
                                min="-90" max="90">
                            <small class="text-muted">Latitude</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="longitude">ุฎุท ุงูุทูู (ุงุฎุชูุงุฑู)</label>
                            <input type="number" id="longitude" class="form-input" placeholder="39.8262" step="any"
                                min="-180" max="180">
                            <small class="text-muted">Longitude</small>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="capacity">ุงูุณุนุฉ ุงูุงุณุชูุนุงุจูุฉ *</label>
                            <input type="number" id="capacity" class="form-input" placeholder="ุนุฏุฏ ุงูุถููู" required
                                min="1" max="50">
                            <span class="form-error" id="capacity-error"></span>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="contact-name">ุงุณู ุงููุณุคูู *</label>
                            <input type="text" id="contact-name" class="form-input" placeholder="ุงูุงุณู ุงููุงูู" required
                                autocomplete="name">
                            <span class="form-error" id="contact-name-error"></span>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู *</label>
                            <input type="email" id="email" class="form-input" placeholder="example@email.com" required
                                autocomplete="email">
                            <span class="form-error" id="email-error"></span>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="phone">ุฑูู ุงูุฌูุงู *</label>
                            <input type="tel" id="phone" class="form-input" placeholder="05xxxxxxxx" required
                                autocomplete="tel" pattern="05[0-9]{8}">
                            <span class="form-error" id="phone-error"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="description">ูุตู ุงููุฌูุณ *</label>
                        <textarea id="description" class="form-textarea"
                            placeholder="ุฃุฎุจุฑ ุงููุนุชูุฑูู ุนู ูุฌูุณูู ูุงูุฎุฏูุงุช ุงูุชู ุชูุฏููููุง..." required
                            rows="4"></textarea>
                        <span class="form-error" id="description-error"></span>
                        <small class="text-muted">ุงูุชุจ ูุตูุงู ุฌุฐุงุจุงู ูุนุฑูู ุงููุนุชูุฑูู ุจุชุฌุฑุจุชูู ุงููุฑูุฏุฉ</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ููุน ุงููุฌูุณ (ูู ุชุณุชูุจูููุ) *</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="majlis_type" value="men" checked>
                                <span>ูุฌูุณ ุฑุฌุงู (ูููุนุชูุฑูู ุงูุฑุฌุงู ููุท)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="majlis_type" value="women">
                                <span>ูุฌูุณ ูุณุงุก (ูููุนุชูุฑุงุช ุงููุณุงุก ููุท)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="majlis_type" value="both">
                                <span>ูุฌูุณ ุนุงุฆูู (ููุฌุฏ ูุณููู ูููุตููู)</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ุงูุจุงูุงุช ุงููุชุงุญุฉ *</label>
                        <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                            <label class="checkbox-label">
                                <input type="checkbox" id="package-simple" name="packages" value="simple">
                                <span>ุจุงูุฉ ุงูุถูุงูุฉ ุงูุจุณูุทุฉ (ูููุฉ + ุชูุฑ + ุชุตููุฑ)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="package-meal" name="packages" value="meal">
                                <span>ุจุงูุฉ ุงููุฌุจุฉ ุงููุงููุฉ (ูุฌุจุฉ + ุถูุงูุฉ + ุชุตููุฑ)</span>
                            </label>
                        </div>
                        <span class="form-error" id="packages-error"></span>
                    </div>

                    <!-- House Gate Image -->
                    <div class="form-group">
                        <label class="form-label" for="gate-image">ุตูุฑุฉ ุจูุงุจุฉ ุงูููุฒู *</label>
                        <div class="file-upload-wrapper">
                            <input type="file" id="gate-image" class="form-input" accept="image/*" required>
                            <small class="text-muted">ูุฑุฌู ุฑูุน ุตูุฑุฉ ูุงุถุญุฉ ูุจูุงุจุฉ ุงูููุฒู ูุชุณููู ูุตูู ุงููุนุชูุฑูู</small>
                        </div>
                        <span class="form-error" id="gate-image-error"></span>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="password">ูููุฉ ุงููุฑูุฑ *</label>
                            <div class="password-input-wrapper">
                                <input type="password" id="password" class="form-input" placeholder="โขโขโขโขโขโขโขโข" required
                                    autocomplete="new-password" minlength="6">
                                <button type="button" class="password-toggle" onclick="togglePassword('password')">
                                    <span class="show-icon">๐๏ธ</span>
                                </button>
                            </div>
                            <span class="form-error" id="password-error"></span>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="confirm-password">ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ *</label>
                            <div class="password-input-wrapper">
                                <input type="password" id="confirm-password" class="form-input" placeholder="โขโขโขโขโขโขโขโข"
                                    required autocomplete="new-password">
                                <button type="button" class="password-toggle"
                                    onclick="togglePassword('confirm-password')">
                                    <span class="show-icon">๐๏ธ</span>
                                </button>
                            </div>
                            <span class="form-error" id="confirm-password-error"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="accept-terms" required>
                            <span>ุฃูุงูู ุนูู <a href="#" class="link-text">ุงูุดุฑูุท ูุงูุฃุญูุงู</a> ู <a href="#"
                                    class="link-text">ุณูุงุณุฉ
                                    ุงูุฎุตูุตูุฉ</a> ู <a href="#" class="link-text">ุดุฑูุท ุงูุฃุณุฑ
                                    ุงููุณุชุถููุฉ</a></span>
                        </label>
                    </div>

                    <!-- Info Box -->
                    <div
                        style="padding: var(--space-lg); background: var(--color-bg-light); border-radius: var(--radius-lg); border-right: 4px solid var(--color-secondary); margin-bottom: var(--space-lg);">
                        <p style="margin: 0; font-size: var(--font-size-sm); color: var(--color-text-light);">
                            <strong>๐ ููุงุญุธุฉ:</strong> ุจุนุฏ ุงูุชุณุฌููุ ุณูุชู ูุฑุงุฌุนุฉ ุทูุจูู ูู ูุจู ูุฑูู ูุฑู ููุชุฃูุฏ ูู ุงุณุชููุงุก
                            ุฌููุน ุงููุนุงููุฑ.
                            ุณูุชูุงุตู ูุนูู ุฎูุงู 48 ุณุงุนุฉ.
                        </p>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block btn-lg">
                        ุชูุฏูู ุงูุทูุจ
                    </button>
                </form>

                <!-- Divider -->
                <div class="divider">
                    <span>ุฃู</span>
                </div>

                <!-- Login Link -->
                <div class="auth-links">
                    <p class="text-center text-muted">
                        ูุฏูู ุญุณุงุจ ุจุงููุนูุ
                        <a href="login.html" class="link-text">ุณุฌู ุฏุฎููู</a>
                    </p>
                </div>

                <!-- Other Register Types -->
                <div class="auth-links mt-lg">
                    <p class="text-center text-muted">ุฃู ุณุฌู ูู:</p>
                    <div class="register-options">
                        <a href="visitor-register.html" class="btn btn-outline btn-sm">ูุนุชูุฑ</a>
                        <a href="company-register.html" class="btn btn-outline btn-sm">ุดุฑูุฉ ุนูุฑุฉ</a>
                    </div>
                </div>

                <!-- Back to Home -->
                <div class="auth-footer">
                    <a href="index.html" class="link-secondary">โ ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</a>
                </div>
            </div>
        </div>

        <!-- Info Side -->
        <div class="info-side">
            <div class="info-pattern"></div>
            <div class="info-content">
                <div class="info-text">
                    <div class="info-icon">๐</div>
                    <h2 class="info-title">ุดุงุฑู ูุฑูู<br>ูุน ุงูุนุงูู</h2>
                    <p class="info-description">
                        ุงูุถู ูุนุงุฆูุฉ ูุฑู ูุงุณุชูุจู ุถููู ุงูุฑุญูู ูู ูุฌูุณูู ุงูุฃุตูู
                        ูุงุญุตู ุนูู ุฏุฎู ุฅุถุงูู ูุน ุงูุญูุงุธ ุนูู ุงูุชุฑุงุซ
                    </p>

                    <div class="info-features">
                        <div class="info-feature">
                            <div class="feature-icon-sm">๐ฐ</div>
                            <span>ุฏุฎู ุฅุถุงูู ูููุฒ</span>
                        </div>
                        <div class="info-feature">
                            <div class="feature-icon-sm">๐ฅ</div>
                            <span>ุงุณุชูุจุงู ุถููู ูู ุงูุนุงูู</span>
                        </div>
                        <div class="info-feature">
                            <div class="feature-icon-sm">๐ฏ</div>
                            <span>ุฅุฏุงุฑุฉ ุณููุฉ ููุญุฌูุฒุงุช</span>
                        </div>
                        <div class="info-feature">
                            <div class="feature-icon-sm">โญ</div>
                            <span>ุฏุนู ููู ูุชูุงุตู</span>
                        </div>
                    </div>

                    <div
                        style="margin-top: var(--space-2xl); padding: var(--space-lg); background: rgba(255,255,255,0.1); border-radius: var(--radius-lg); backdrop-filter: blur(10px);">
                        <p style="margin: 0; color: rgba(255,255,255,0.9); font-size: var(--font-size-sm);">
                            ๐ก <strong>ูุตูุญุฉ:</strong> ุงูุฃุณุฑ ุฐุงุช ุงูุชููููุงุช ุงูุนุงููุฉ ุชุญุตู ุนูู ุญุฌูุฒุงุช ุฃูุซุฑ ุจูุณุจุฉ 70%
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Show Google Maps help
        function showMapsHelp() {
            const helpText = `
๐ ููููุฉ ุงูุญุตูู ุนูู ุฑุงุจุท ูููุน Google Maps:

1๏ธโฃ ุงูุชุญ Google Maps (maps.google.com)
2๏ธโฃ ุงุจุญุซ ุนู ูููุน ูุฌูุณูู
3๏ธโฃ ุงุถุบุท ุนูู "ูุดุงุฑูุฉ" ุฃู "Share"
4๏ธโฃ ุงุฎุชุฑ "ูุณุฎ ุงูุฑุงุจุท" ุฃู "Copy link"
5๏ธโฃ ุงูุตู ุงูุฑุงุจุท ูู ุงูุญูู ุฃุนูุงู

โจ ุฃู ููููู ุฅุฏุฎุงู ุงูุฅุญุฏุงุซูุงุช ูุจุงุดุฑุฉ (ุฎุท ุงูุนุฑุถ ูุงูุทูู)
            `;

            if (typeof showToast !== 'undefined') {
                showToast('ูุณุงุนุฏุฉ', helpText.trim(), 'info');
            } else {
                alert(helpText);
            }
        }

        // Handle register form submission
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('family-register-form');
            if (form) {
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    // Try namespace first, then fallback
                    if (window.Karam && window.Karam.Auth && window.Karam.Auth.handleFamilyRegister) {
                        await Karam.Auth.handleFamilyRegister();
                    } else if (window.handleFamilyRegister) {
                        await window.handleFamilyRegister();
                    } else {
                        console.error('Registration handler not found');
                        alert('ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุตูุญุฉ. ูุฑุฌู ุงูุชุญุฏูุซ ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
                    }
                });
            }
        });
    </script>
</body>

</html>